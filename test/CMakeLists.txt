SET(PROJECT_NAME MyTestApp)

PROJECT(${PROJECT_NAME} LANGUAGES C)
CMAKE_MINIMUM_REQUIRED(VERSION 3.21)

SET(PROJECT_VERSION 1.5.89)

ADD_SUBDIRECTORY(shared_out_of_dir_symlink)
ADD_SUBDIRECTORY(shared_with_soname)

RETURN()

FIND_PACKAGE(CMLIB COMPONENTS CMDEF REQUIRED)

CMDEF_ADD_EXECUTABLE(
    TARGET ${PROJECT_NAME}
    SOURCES main.c
    VERSION ${PROJECT_VERSION}
)
TARGET_LINK_LIBRARIES(${PROJECT_NAME} PUBLIC shared_out_of_dir_symlink-shared shared_with_soname-shared)

CMDEF_INSTALL(TARGET ${PROJECT_NAME})

# Create a package
CMDEF_PACKAGE(
    MAIN_TARGET ${PROJECT_NAME}
    VERSION     ${PROJECT_VERSION}
)

SET(CPACK_GENERATOR ZIP)
INCLUDE(CPack)